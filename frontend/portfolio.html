<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Portfolio - Scopira</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Add jsPDF library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo">
                    <h2><i class="fas fa-compass"></i> Scopira</h2>
                </div>
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">Home</a>
                    </li>
                    <li class="nav-item">
                        <a href="dashboard.html" class="nav-link">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a href="jobs.html" class="nav-link">Jobs</a>
                    </li>
                    <li class="nav-item">
                        <a href="portfolio.html" class="nav-link">Portfolio</a>
                    </li>
                    <li class="nav-item">
                        <a href="profile.html" class="nav-link">Profile</a>
                    </li>
                    <!-- User Profile Dropdown -->
                    <li class="nav-item user-dropdown">
                        <a href="#" class="nav-link user-link">
                            <i class="fas fa-user-circle"></i> John Doe <i class="fas fa-caret-down"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="profile.html"><i class="fas fa-user"></i> My Profile</a></li>
                            <li><a href="resume-editor.html"><i class="fas fa-file-alt"></i> Resume Editor</a></li>
                            <li><a href="portfolio.html"><i class="fas fa-briefcase"></i> My Portfolio</a></li>
                            <li><a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                        </ul>
                    </li>
                </ul>
                <div class="hamburger">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
            </div>
        </nav>
    </header>

    <!-- Portfolio Section -->
    <section id="portfolio" class="portfolio">
        <div class="container">
            <div class="portfolio-header">
                <h1 id="portfolio-title">John Doe's Portfolio</h1>
                <div class="portfolio-actions">
                    <button class="btn primary-btn" id="edit-portfolio-btn"><i class="fas fa-edit"></i> Edit Portfolio</button>
                    <button class="btn secondary-btn" id="download-pdf-btn"><i class="fas fa-file-pdf"></i> Download PDF</button>
                    <button class="btn secondary-btn" id="share-btn"><i class="fas fa-share-alt"></i> Share</button>
                </div>
            </div>

            <!-- About Section -->
            <div class="portfolio-section">
                <h2><i class="fas fa-user"></i> About Me</h2>
                <div class="about-content">
                    <div class="profile-image">
                        <img src="assets/profile-placeholder.png" alt="Profile Image" id="profile-image">
                    </div>
                    <div class="profile-details">
                        <h3 id="profile-title">Senior Data Scientist</h3>
                        <p id="profile-description">I'm a passionate data scientist with 5+ years of experience in machine learning, statistical analysis, and data visualization. I specialize in Python, TensorFlow, and cloud-based data solutions.</p>
                        <div class="contact-info">
                            <p><i class="fas fa-envelope"></i> <span id="email">john.doe@example.com</span></p>
                            <p><i class="fas fa-map-marker-alt"></i> <span id="location">San Francisco, CA</span></p>
                            <p><i class="fab fa-linkedin"></i> <span id="linkedin">linkedin.com/in/johndoe</span></p>
                            <p><i class="fab fa-github"></i> <span id="github">github.com/johndoe</span></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Skills Section -->
            <div class="portfolio-section">
                <h2><i class="fas fa-star"></i> Skills</h2>
                <div class="skills-grid">
                    <div class="skill-category">
                        <h3>Technical Skills</h3>
                        <div class="skill-tags" id="technical-skills">
                            <span class="skill-tag">Python</span>
                            <span class="skill-tag">Machine Learning</span>
                            <span class="skill-tag">TensorFlow</span>
                            <span class="skill-tag">SQL</span>
                            <span class="skill-tag">Data Visualization</span>
                            <span class="skill-tag">Statistical Analysis</span>
                        </div>
                    </div>
                    <div class="skill-category">
                        <h3>Soft Skills</h3>
                        <div class="skill-tags" id="soft-skills">
                            <span class="skill-tag">Communication</span>
                            <span class="skill-tag">Problem Solving</span>
                            <span class="skill-tag">Leadership</span>
                            <span class="skill-tag">Team Collaboration</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Experience Section -->
            <div class="portfolio-section">
                <h2><i class="fas fa-briefcase"></i> Experience</h2>
                <div class="timeline" id="experience-timeline">
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <h3>Senior Data Scientist</h3>
                            <p class="company">TechCorp Inc.</p>
                            <p class="duration">Jan 2022 - Present</p>
                            <p>Lead machine learning initiatives and mentor junior data scientists. Developed recommendation systems that increased user engagement by 35%.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <h3>Data Scientist</h3>
                            <p class="company">DataSystems Ltd</p>
                            <p class="duration">Mar 2020 - Dec 2021</p>
                            <p>Built predictive models for customer behavior analysis. Reduced customer churn by 20% through targeted interventions.</p>
                        </div>
                    </div>
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <h3>Data Analyst</h3>
                            <p class="company">StartupXYZ</p>
                            <p class="duration">Jun 2018 - Feb 2020</p>
                            <p>Performed statistical analysis and created dashboards for business intelligence. Automated reporting processes, saving 10 hours per week.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Projects Section -->
            <div class="portfolio-section">
                <h2><i class="fas fa-project-diagram"></i> Projects</h2>
                <div class="projects-grid" id="projects-grid">
                    <div class="project-card">
                        <h3>Customer Churn Prediction</h3>
                        <p class="project-description">Developed a machine learning model to predict customer churn with 92% accuracy, saving the company $2M annually.</p>
                        <div class="project-tags">
                            <span class="tag">Python</span>
                            <span class="tag">Scikit-learn</span>
                            <span class="tag">Data Analysis</span>
                        </div>
                        <div class="project-links">
                            <a href="#" class="btn secondary-btn">View Code</a>
                            <a href="#" class="btn secondary-btn">Live Demo</a>
                        </div>
                    </div>
                    <div class="project-card">
                        <h3>Real-time Fraud Detection</h3>
                        <p class="project-description">Built a real-time fraud detection system using streaming data and anomaly detection algorithms.</p>
                        <div class="project-tags">
                            <span class="tag">TensorFlow</span>
                            <span class="tag">Kafka</span>
                            <span class="tag">AWS</span>
                        </div>
                        <div class="project-links">
                            <a href="#" class="btn secondary-btn">View Code</a>
                            <a href="#" class="btn secondary-btn">Live Demo</a>
                        </div>
                    </div>
                    <div class="project-card">
                        <h3>Sales Forecasting Dashboard</h3>
                        <p class="project-description">Created an interactive dashboard for sales forecasting that improved planning accuracy by 25%.</p>
                        <div class="project-tags">
                            <span class="tag">Tableau</span>
                            <span class="tag">Python</span>
                            <span class="tag">Data Visualization</span>
                        </div>
                        <div class="project-links">
                            <a href="#" class="btn secondary-btn">View Code</a>
                            <a href="#" class="btn secondary-btn">Live Demo</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Certifications Section -->
            <div class="portfolio-section">
                <h2><i class="fas fa-certificate"></i> Certifications</h2>
                <div class="certifications-grid" id="certifications-grid">
                    <div class="certification-card">
                        <h3>Google Professional Data Engineer</h3>
                        <p class="issuer">Google Cloud</p>
                        <p class="date">Issued: Mar 2023</p>
                    </div>
                    <div class="certification-card">
                        <h3>TensorFlow Developer Certificate</h3>
                        <p class="issuer">TensorFlow</p>
                        <p class="date">Issued: Nov 2022</p>
                    </div>
                    <div class="certification-card">
                        <h3>AWS Certified Machine Learning</h3>
                        <p class="issuer">Amazon Web Services</p>
                        <p class="date">Issued: Jun 2022</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Edit Portfolio Modal -->
    <div id="edit-modal" class="edit-modal">
        <div class="edit-modal-content">
            <div class="edit-modal-header">
                <h2>Edit Portfolio</h2>
                <button class="close-edit-modal">&times;</button>
            </div>
            <div class="edit-modal-body">
                <form id="portfolio-form">
                    <div class="form-group">
                        <label for="edit-name">Full Name</label>
                        <input type="text" id="edit-name" value="John Doe">
                    </div>
                    <div class="form-group">
                        <label for="edit-title">Professional Title</label>
                        <input type="text" id="edit-title" value="Senior Data Scientist">
                    </div>
                    <div class="form-group">
                        <label for="edit-description">Professional Summary</label>
                        <textarea id="edit-description">I'm a passionate data scientist with 5+ years of experience in machine learning, statistical analysis, and data visualization. I specialize in Python, TensorFlow, and cloud-based data solutions.</textarea>
                    </div>
                    <div class="form-group">
                        <label for="edit-email">Email</label>
                        <input type="email" id="edit-email" value="john.doe@example.com">
                    </div>
                    <div class="form-group">
                        <label for="edit-location">Location</label>
                        <input type="text" id="edit-location" value="San Francisco, CA">
                    </div>
                    <div class="form-group">
                        <label for="edit-linkedin">LinkedIn Profile</label>
                        <input type="text" id="edit-linkedin" value="linkedin.com/in/johndoe">
                    </div>
                    <div class="form-group">
                        <label for="edit-github">GitHub Profile</label>
                        <input type="text" id="edit-github" value="github.com/johndoe">
                    </div>
                    <!-- Skills Section -->
                    <div class="form-group">
                        <label for="edit-technical-skills">Technical Skills (comma separated)</label>
                        <input type="text" id="edit-technical-skills" value="Python, Machine Learning, TensorFlow, SQL, Data Visualization, Statistical Analysis">
                    </div>
                    <div class="form-group">
                        <label for="edit-soft-skills">Soft Skills (comma separated)</label>
                        <input type="text" id="edit-soft-skills" value="Communication, Problem Solving, Leadership, Team Collaboration">
                    </div>
                    <!-- Experience Section -->
                    <div class="form-group">
                        <label for="edit-experience">Experience (JSON format)</label>
                        <textarea id="edit-experience" rows="6">[
    {
        "title": "Senior Data Scientist",
        "company": "TechCorp Inc.",
        "duration": "Jan 2022 - Present",
        "description": "Lead machine learning initiatives and mentor junior data scientists. Developed recommendation systems that increased user engagement by 35%."
    },
    {
        "title": "Data Scientist",
        "company": "DataSystems Ltd",
        "duration": "Mar 2020 - Dec 2021",
        "description": "Built predictive models for customer behavior analysis. Reduced customer churn by 20% through targeted interventions."
    },
    {
        "title": "Data Analyst",
        "company": "StartupXYZ",
        "duration": "Jun 2018 - Feb 2020",
        "description": "Performed statistical analysis and created dashboards for business intelligence. Automated reporting processes, saving 10 hours per week."
    }
]</textarea>
                    </div>
                    <!-- Projects Section -->
                    <div class="form-group">
                        <label for="edit-projects">Projects (JSON format)</label>
                        <textarea id="edit-projects" rows="6">[
    {
        "title": "Customer Churn Prediction",
        "description": "Developed a machine learning model to predict customer churn with 92% accuracy, saving the company $2M annually.",
        "tags": "Python, Scikit-learn, Data Analysis"
    },
    {
        "title": "Real-time Fraud Detection",
        "description": "Built a real-time fraud detection system using streaming data and anomaly detection algorithms.",
        "tags": "TensorFlow, Kafka, AWS"
    },
    {
        "title": "Sales Forecasting Dashboard",
        "description": "Created an interactive dashboard for sales forecasting that improved planning accuracy by 25%.",
        "tags": "Tableau, Python, Data Visualization"
    }
]</textarea>
                    </div>
                    <!-- Certifications Section -->
                    <div class="form-group">
                        <label for="edit-certifications">Certifications (JSON format)</label>
                        <textarea id="edit-certifications" rows="4">[
    {
        "title": "Google Professional Data Engineer",
        "issuer": "Google Cloud",
        "date": "Issued: Mar 2023"
    },
    {
        "title": "TensorFlow Developer Certificate",
        "issuer": "TensorFlow",
        "date": "Issued: Nov 2022"
    },
    {
        "title": "AWS Certified Machine Learning",
        "issuer": "Amazon Web Services",
        "date": "Issued: Jun 2022"
    }
]</textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn secondary-btn" id="cancel-edit">Cancel</button>
                        <button type="submit" class="btn primary-btn">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-logo">
                <h3><i class="fas fa-compass"></i> Scopira</h3>
                <p>AI-Powered Career Guidance Platform</p>
            </div>
            <div class="footer-links">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="jobs.html">Jobs</a></li>
                    <li><a href="portfolio.html">Portfolio</a></li>
                </ul>
            </div>
            <div class="footer-social">
                <h4>Follow Us</h4>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-linkedin"></i></a>
                    <a href="#"><i class="fab fa-github"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Scopira. All rights reserved.</p>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;
        const API_BASE = 'http://localhost:5000/api';
        let currentUser = null;
        let currentPortfolio = null;
        
        document.addEventListener('DOMContentLoaded', function() {
            loadPortfolioData();

            // Edit portfolio functionality
            const editBtn = document.getElementById('edit-portfolio-btn');
            const editModal = document.getElementById('edit-modal');
            const closeEditModal = document.querySelector('.close-edit-modal');
            const cancelEdit = document.getElementById('cancel-edit');
            const portfolioForm = document.getElementById('portfolio-form');
            
            // Download PDF functionality
            const downloadPdfBtn = document.getElementById('download-pdf-btn');
            
            // Share functionality
            const shareBtn = document.getElementById('share-btn');
            
            // Open edit modal
            editBtn.addEventListener('click', function() {
                populateEditForm();
                editModal.style.display = 'flex';
            });
            
            // Close edit modal
            closeEditModal.addEventListener('click', function() {
                editModal.style.display = 'none';
            });
            
            cancelEdit.addEventListener('click', function() {
                editModal.style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === editModal) {
                    editModal.style.display = 'none';
                }
            });
            
            // Save portfolio changes
            portfolioForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                try {
                    // Prepare data for update
                    const updatedPortfolio = {
                        skills: {
                            technical: document.getElementById('edit-technical-skills').value.split(',').map(s => s.trim()).filter(s => s),
                            soft: document.getElementById('edit-soft-skills').value.split(',').map(s => s.trim()).filter(s => s)
                        },
                        experience: JSON.parse(document.getElementById('edit-experience').value),
                        projects: JSON.parse(document.getElementById('edit-projects').value),
                        certifications: JSON.parse(document.getElementById('edit-certifications').value)
                    };

                    // Also update user profile data if changed
                    const updatedUser = {
                        first_name: document.getElementById('edit-name').value.split(' ')[0],
                        last_name: document.getElementById('edit-name').value.split(' ').slice(1).join(' '),
                        headline: document.getElementById('edit-title').value,
                        summary: document.getElementById('edit-description').value,
                        email: document.getElementById('edit-email').value,
                        location: document.getElementById('edit-location').value
                        // Note: LinkedIn/GitHub would need new fields in User model or Portfolio preferences
                    };

                    // Update Portfolio
                    const portfolioResponse = await fetch(`${API_BASE}/portfolio/${currentUser.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(updatedPortfolio)
                    });

                    // Update User Profile
                    const userResponse = await fetch(`${API_BASE}/users/${currentUser.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(updatedUser)
                    });

                    if (portfolioResponse.ok && userResponse.ok) {
                        alert('Portfolio updated successfully!');
                        editModal.style.display = 'none';
                        loadPortfolioData(); // Reload to show changes
                    } else {
                        throw new Error('Failed to update portfolio or profile');
                    }

                } catch (error) {
                    console.error('Error updating portfolio:', error);
                    alert('Error updating portfolio. Please check your JSON formatting.');
                }
            });
            
            // Download PDF functionality
            downloadPdfBtn.addEventListener('click', function() {
                // Show loading message
                const originalText = downloadPdfBtn.innerHTML;
                downloadPdfBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating PDF...';
                downloadPdfBtn.disabled = true;
                
                // Use html2canvas to capture the portfolio content
                const portfolioElement = document.querySelector('#portfolio .container');
                
                html2canvas(portfolioElement, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    scrollY: -window.scrollY,
                    scrollX: -window.scrollX
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    const imgWidth = 210; // A4 width in mm
                    const pageHeight = 297; // A4 height in mm
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    let heightLeft = imgHeight;
                    let position = 0;
                    
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                    
                    // Add new pages if content is taller than one page
                    while (heightLeft >= 0) {
                        position = heightLeft - imgHeight;
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }
                    
                    // Save the PDF
                    const portfolioTitle = document.getElementById('portfolio-title').textContent;
                    const fileName = portfolioTitle.replace(/[^a-zA-Z0-9]/g, '_') + '.pdf';
                    pdf.save(fileName);
                    
                    // Restore button
                    downloadPdfBtn.innerHTML = originalText;
                    downloadPdfBtn.disabled = false;
                    
                    // Log the action
                    console.log('Portfolio PDF generated and downloaded');
                }).catch(error => {
                    console.error('Error generating PDF:', error);
                    alert('Error generating PDF. Please try again.');
                    
                    // Restore button
                    downloadPdfBtn.innerHTML = originalText;
                    downloadPdfBtn.disabled = false;
                });
            });
            
            // Share functionality
            shareBtn.addEventListener('click', function() {
                alert('Share options would appear here! In a real implementation, you could share your portfolio via email, social media, or copy a link.');
            });
        });

        async function loadPortfolioData() {
            const userStr = localStorage.getItem('user');
            if (!userStr) {
                window.location.href = 'login.html';
                return;
            }
            currentUser = JSON.parse(userStr);

            try {
                // Fetch User Data
                const userRes = await fetch(`${API_BASE}/users/${currentUser.id}`);
                if (userRes.ok) {
                    const userData = await userRes.json();
                    currentUser = userData.user;
                    updateUserProfileUI(currentUser);
                }

                // Fetch Portfolio Data
                const portfolioRes = await fetch(`${API_BASE}/portfolio/${currentUser.id}`);
                if (portfolioRes.ok) {
                    const data = await portfolioRes.json();
                    currentPortfolio = data.portfolio;
                    updatePortfolioUI(currentPortfolio);
                }
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        function updateUserProfileUI(user) {
            document.getElementById('portfolio-title').textContent = `${user.first_name} ${user.last_name}'s Portfolio`;
            document.getElementById('profile-title').textContent = user.headline || user.profession || 'Professional';
            document.getElementById('profile-description').textContent = user.summary || 'No summary provided.';
            document.getElementById('email').textContent = user.email;
            document.getElementById('location').textContent = user.location || 'Location not set';
            // Note: LinkedIn/GitHub are placeholders as they aren't in User model yet
        }

        function updatePortfolioUI(portfolio) {
            // Parse JSON strings if they come as strings
            const skills = typeof portfolio.skills === 'string' ? JSON.parse(portfolio.skills) : portfolio.skills;
            const experience = typeof portfolio.experience === 'string' ? JSON.parse(portfolio.experience) : portfolio.experience;
            const projects = typeof portfolio.projects === 'string' ? JSON.parse(portfolio.projects) : portfolio.projects;
            const certifications = typeof portfolio.certifications === 'string' ? JSON.parse(portfolio.certifications) : portfolio.certifications;

            // Update Skills
            if (skills) {
                updateSkillsList('technical-skills', skills.technical || []);
                updateSkillsList('soft-skills', skills.soft || []);
            }

            // Update Experience
            if (experience) {
                const timelineContainer = document.getElementById('experience-timeline');
                timelineContainer.innerHTML = experience.map(exp => `
                    <div class="timeline-item">
                        <div class="timeline-marker"></div>
                        <div class="timeline-content">
                            <h3>${exp.title}</h3>
                            <p class="company">${exp.company}</p>
                            <p class="duration">${exp.duration}</p>
                            <p>${exp.description}</p>
                        </div>
                    </div>
                `).join('');
            }

            // Update Projects
            if (projects) {
                const projectsContainer = document.getElementById('projects-grid');
                projectsContainer.innerHTML = projects.map(project => `
                    <div class="project-card">
                        <h3>${project.title}</h3>
                        <p class="project-description">${project.description}</p>
                        <div class="project-tags">
                            ${project.tags.split(',').map(tag => `<span class="tag">${tag.trim()}</span>`).join('')}
                        </div>
                        <div class="project-links">
                            <a href="#" class="btn secondary-btn">View Code</a>
                            <a href="#" class="btn secondary-btn">Live Demo</a>
                        </div>
                    </div>
                `).join('');
            }

            // Update Certifications
            if (certifications) {
                const certificationsContainer = document.getElementById('certifications-grid');
                certificationsContainer.innerHTML = certifications.map(cert => `
                    <div class="certification-card">
                        <h3>${cert.title}</h3>
                        <p class="issuer">${cert.issuer}</p>
                        <p class="date">${cert.date}</p>
                    </div>
                `).join('');
            }
        }

        function updateSkillsList(elementId, skillsArray) {
            const container = document.getElementById(elementId);
            if (container && skillsArray) {
                container.innerHTML = skillsArray.map(skill => `<span class="skill-tag">${skill}</span>`).join('');
            }
        }

        function populateEditForm() {
            if (!currentUser || !currentPortfolio) return;

            // User Info
            document.getElementById('edit-name').value = `${currentUser.first_name} ${currentUser.last_name}`;
            document.getElementById('edit-title').value = currentUser.headline || '';
            document.getElementById('edit-description').value = currentUser.summary || '';
            document.getElementById('edit-email').value = currentUser.email || '';
            document.getElementById('edit-location').value = currentUser.location || '';

            // Portfolio Info
            const skills = typeof currentPortfolio.skills === 'string' ? JSON.parse(currentPortfolio.skills) : currentPortfolio.skills;
            if (skills) {
                document.getElementById('edit-technical-skills').value = (skills.technical || []).join(', ');
                document.getElementById('edit-soft-skills').value = (skills.soft || []).join(', ');
            }

            document.getElementById('edit-experience').value = typeof currentPortfolio.experience === 'string' ? currentPortfolio.experience : JSON.stringify(currentPortfolio.experience, null, 4);
            document.getElementById('edit-projects').value = typeof currentPortfolio.projects === 'string' ? currentPortfolio.projects : JSON.stringify(currentPortfolio.projects, null, 4);
            document.getElementById('edit-certifications').value = typeof currentPortfolio.certifications === 'string' ? currentPortfolio.certifications : JSON.stringify(currentPortfolio.certifications, null, 4);
        }
    </script>
</body>
</html>